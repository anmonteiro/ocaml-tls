<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Engine" rel="Chapter" href="Engine.html">
<link title="Config" rel="Chapter" href="Config.html">
<link title="Packet" rel="Chapter" href="Packet.html">
<link title="Ciphersuite" rel="Chapter" href="Ciphersuite.html">
<link title="Core" rel="Chapter" href="Core.html">
<link title="Tls_lwt" rel="Chapter" href="Tls_lwt.html">
<link title="X509_lwt" rel="Chapter" href="X509_lwt.html">
<link title="Tls_mirage" rel="Chapter" href="Tls_mirage.html"><title>Engine</title>
</head>
<body>
<code class="code"><span class="keyword">sig</span><br>
&nbsp;&nbsp;<span class="keyword">type</span>&nbsp;state<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;client&nbsp;:&nbsp;<span class="constructor">Config</span>.client&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Engine</span>.state&nbsp;*&nbsp;<span class="constructor">Cstruct</span>.t<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;server&nbsp;:&nbsp;<span class="constructor">Config</span>.server&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Engine</span>.state<br>
&nbsp;&nbsp;<span class="keyword">type</span>&nbsp;error&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;<span class="keywordsign">`</span><span class="constructor">AuthenticationFailure</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">X509</span>.<span class="constructor">Validation</span>.validation_error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">CouldntSelectCertificate</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoCertificateConfigured</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoConfiguredCiphersuite</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Ciphersuite</span>.ciphersuite&nbsp;list<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoConfiguredHash</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Nocrypto</span>.<span class="constructor">Hash</span>.hash&nbsp;list<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoConfiguredVersion</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Core</span>.tls_version<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoMatchingCertificateFound</span>&nbsp;<span class="keyword">of</span>&nbsp;string&nbsp;]<br>
&nbsp;&nbsp;<span class="keyword">type</span>&nbsp;fatal&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;<span class="keywordsign">`</span><span class="constructor">BadCertificateChain</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">BadFinished</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">BadRecordVersion</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Core</span>.tls_any_version<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">CannotHandleApplicationDataYet</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">HandshakeFragmentsNotEmpty</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">HashAlgorithmMismatch</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InappropriateFallback</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InvalidCertificateExtendedUsage</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InvalidCertificateUsage</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InvalidClientHello</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InvalidDH</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InvalidRenegotiation</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InvalidRenegotiationVersion</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Core</span>.tls_version<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InvalidServerHello</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InvalidSession</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">KeyTooSmall</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">MACMismatch</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">MACUnderflow</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoApplicationProtocol</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoCertificateReceived</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoCiphersuite</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Packet</span>.any_ciphersuite&nbsp;list<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoHeartbeat</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoSecureRenegotiation</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NoVersion</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Core</span>.tls_any_version<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NotRSACertificate</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">NotRSASignature</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">RSASignatureMismatch</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">RSASignatureVerificationFailed</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">ReaderError</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Reader</span>.error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">RecordOverflow</span>&nbsp;<span class="keyword">of</span>&nbsp;int<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">UnexpectedCCS</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">UnexpectedHandshake</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Core</span>.tls_handshake<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">UnknownContentType</span>&nbsp;<span class="keyword">of</span>&nbsp;int<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">UnknownRecordVersion</span>&nbsp;<span class="keyword">of</span>&nbsp;int&nbsp;*&nbsp;int&nbsp;]<br>
&nbsp;&nbsp;<span class="keyword">type</span>&nbsp;failure&nbsp;=&nbsp;[&nbsp;<span class="keywordsign">`</span><span class="constructor">Error</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Engine</span>.error&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Fatal</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Engine</span>.fatal&nbsp;]<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;alert_of_failure&nbsp;:&nbsp;<span class="constructor">Engine</span>.failure&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Packet</span>.alert_type<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;string_of_failure&nbsp;:&nbsp;<span class="constructor">Engine</span>.failure&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;string<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;failure_of_sexp&nbsp;:&nbsp;<span class="constructor">Sexplib</span>.<span class="constructor">Sexp</span>.t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Engine</span>.failure<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;sexp_of_failure&nbsp;:&nbsp;<span class="constructor">Engine</span>.failure&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Sexplib</span>.<span class="constructor">Sexp</span>.t<br>
&nbsp;&nbsp;<span class="keyword">type</span>&nbsp;ret&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;<span class="keywordsign">`</span><span class="constructor">Fail</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Engine</span>.failure&nbsp;*&nbsp;[&nbsp;<span class="keywordsign">`</span><span class="constructor">Response</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Cstruct</span>.t&nbsp;]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Ok</span>&nbsp;<span class="keyword">of</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;<span class="keywordsign">`</span><span class="constructor">Alert</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Packet</span>.alert_type&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Eof</span>&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Ok</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Engine</span>.state&nbsp;]&nbsp;*<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;<span class="keywordsign">`</span><span class="constructor">Response</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Cstruct</span>.t&nbsp;option&nbsp;]&nbsp;*&nbsp;[&nbsp;<span class="keywordsign">`</span><span class="constructor">Data</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Cstruct</span>.t&nbsp;option&nbsp;]&nbsp;]<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;handle_tls&nbsp;:&nbsp;<span class="constructor">Engine</span>.state&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Cstruct</span>.t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Engine</span>.ret<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;can_handle_appdata&nbsp;:&nbsp;<span class="constructor">Engine</span>.state&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;bool<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;handshake_in_progress&nbsp;:&nbsp;<span class="constructor">Engine</span>.state&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;bool<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;send_application_data&nbsp;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Engine</span>.state&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Cstruct</span>.t&nbsp;list&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(<span class="constructor">Engine</span>.state&nbsp;*&nbsp;<span class="constructor">Cstruct</span>.t)&nbsp;option<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;send_close_notify&nbsp;:&nbsp;<span class="constructor">Engine</span>.state&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Engine</span>.state&nbsp;*&nbsp;<span class="constructor">Cstruct</span>.t<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;reneg&nbsp;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;?authenticator:<span class="constructor">X509</span>.<span class="constructor">Authenticator</span>.a&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;?acceptable_cas:<span class="constructor">X509</span>.distinguished_name&nbsp;list&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;?cert:<span class="constructor">Config</span>.own_cert&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Engine</span>.state&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;(<span class="constructor">Engine</span>.state&nbsp;*&nbsp;<span class="constructor">Cstruct</span>.t)&nbsp;option<br>
&nbsp;&nbsp;<span class="keyword">type</span>&nbsp;epoch&nbsp;=&nbsp;[&nbsp;<span class="keywordsign">`</span><span class="constructor">Epoch</span>&nbsp;<span class="keyword">of</span>&nbsp;<span class="constructor">Core</span>.epoch_data&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">InitialEpoch</span>&nbsp;]<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;epoch_of_sexp&nbsp;:&nbsp;<span class="constructor">Sexplib</span>.<span class="constructor">Sexp</span>.t&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Engine</span>.epoch<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;sexp_of_epoch&nbsp;:&nbsp;<span class="constructor">Engine</span>.epoch&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Sexplib</span>.<span class="constructor">Sexp</span>.t<br>
&nbsp;&nbsp;<span class="keyword">val</span>&nbsp;epoch&nbsp;:&nbsp;<span class="constructor">Engine</span>.state&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Engine</span>.epoch<br>
<span class="keyword">end</span></code></body></html>
